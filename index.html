<script>
  
  const weekends = [
    {
      label: "Week 1",
      saturday: { date: "Sat, Dec 6, 2025", names: ["Bridgette","Stefanie","Missie","Dana","Nate","Kelsey","Becca"] },
      sunday:   { date: "Sun, Dec 7, 2025", names: ["Bridgette","Stefanie","Mahala","Becca","Abby","John"] }
    },
    {
      label: "Week 2",
      saturday: { date: "Sat, Dec 13, 2025", names: ["Bridgette","Stefanie","Missie","Dana","Becca","Abby","John"] },
      sunday:   { date: "Sun, Dec 14, 2025", names: ["Bridgette","Stefanie","Mahala","Missie","Paige","Julia"] }
    },
    {
      label: "Week 3",
      saturday: { date: "Sat, Dec 20, 2025", names: ["Bridgette","Stefanie","Missie","Dana","Paige","Kathy","John"] },
      sunday:   { date: "Sun, Dec 21, 2025", names: ["Bridgette","Stefanie","Mahala","Kathy","Hannah","Julia"] }
    },
    {
      label: "Week 4",
      saturday: { date: "Sat, Dec 27, 2025", names: ["Bridgette","Stefanie","Missie","Dana","Kathy","Hannah","Maddie"] },
      sunday:   { date: "Sun, Dec 28, 2025", names: ["Bridgette","Stefanie","Mahala","Julia","Rebakah","Maddie"] }
    },
    {
      label: "Week 5",
      saturday: { date: "Sat, Jan 3, 2026", names: ["Bridgette","Stefanie","Missie","Dana","Maddie","Kay","Julia"] },
      sunday:   { date: "Sun, Jan 4, 2026", names: ["Bridgette","Stefanie","Mahala","Missie","Nate","Kelsey"] }
    },
    {
      label: "Week 6",
      saturday: { date: "Sat, Jan 10, 2026", names: ["Bridgette","Stefanie","Missie","Dana","Julia","Rebakah","John"] },
      sunday:   { date: "Sun, Jan 11, 2026", names: ["Bridgette","Stefanie","Mahala","Kay","Becca","Abby"] }
    },
    {
      label: "Week 7",
      saturday: { date: "Sat, Jan 17, 2026", names: ["Bridgette","Stefanie","Missie","Dana","Nate","Kelsey","Paige"] },
      sunday:   { date: "Sun, Jan 18, 2026", names: ["Bridgette","Stefanie","Mahala","John","Kathy","Hannah"] }
    },
    {
      label: "Week 8",
      saturday: { date: "Sat, Jan 24, 2026", names: ["Bridgette","Stefanie","Missie","Dana","Becca","Abby","Hannah"] },
      sunday:   { date: "Sun, Jan 25, 2026", names: ["Bridgette","Stefanie","Mahala","Missie","Julia","Rebakah"] }
    },
    {
      label: "Week 9",
      saturday: { date: "Sat, Jan 31, 2026", names: ["Bridgette","Stefanie","Missie","Dana","Paige","Kay","John"] },
      sunday:   { date: "Sun, Feb 1, 2026", names: ["Bridgette","Stefanie","Mahala","Maddie","Kay","Holli"] }
    },
    {
      label: "Week 10",
      saturday: { date: "Sat, Feb 7, 2026", names: ["Bridgette","Stefanie","Missie","Dana","Kathy","Hannah","Julia"] },
      sunday:   { date: "Sun, Feb 8, 2026", names: ["Bridgette","Stefanie","Mahala","Nate","Kelsey","Becca"] }
    },
    {
      label: "Week 11",
      saturday: { date: "Sat, Feb 14, 2026", names: ["Bridgette","Stefanie","Missie","Dana","Maddie","Kay","Rebakah"] },
      sunday:   { date: "Sun, Feb 15, 2026", names: ["Bridgette","Stefanie","Mahala","Missie","John","Holli"] }
    },
    {
      label: "Week 12",
      saturday: { date: "Sat, Feb 21, 2026", names: ["Bridgette","Stefanie","Missie","Dana","Julia","Rebakah","Abby"] },
      sunday:   { date: "Sun, Feb 22, 2026", names: ["Bridgette","Stefanie","Mahala","Paige","Maddie","Kay"] }
    }
  ];

  
  const fairnessPriority = [
    "John",
    "Holli",
    "Becca",
    "Abby",
    "Hannah",
    "Paige",
    "Kathy",
    "Maddie",
    "Kay",
    "Julia",
    "Rebakah"
  ];

  const colorMap = {
    "Bridgette": "black",
    "Stefanie": "dimgray",
    "Missie": "purple",
    "Dana": "brown",
    "Mahala": "teal",
    "Nate": "darkorange",
    "Kelsey": "darkorange",
    "Becca": "darkgreen",
    "Abby": "forestgreen",
    "Holli": "royalblue",
    "Paige": "slateblue",
    "Kathy": "darkred",
    "Hannah": "olive",
    "Maddie": "darkcyan",
    "Kay": "chocolate",
    "Julia": "mediumvioletred",
    "Rebakah": "red",
    "John": "navy"
  };

  const weekContainer = document.getElementById("weekContainer");
  const satCountInput = document.getElementById("satCount");
  const sunCountInput = document.getElementById("sunCount");
  const employeeFilter = document.getElementById("employeeFilter");

  // build employee list
  const allNames = new Set();
  weekends.forEach(w => {
    w.saturday.names.forEach(n => allNames.add(n));
    w.sunday.names.forEach(n => allNames.add(n));
  });
  Array.from(allNames).sort().forEach(n => {
    const opt = document.createElement("option");
    opt.value = n;
    opt.textContent = n;
    employeeFilter.appendChild(opt);
  });

  function isMissieSunday(names) {
    return names.includes("Missie");
  }

  // NEW: apply fairness priority after core
  function getDisplayNames(dayNames, isSunday, requestedCount) {
    // build core
    let core = [];
    if (!isSunday) {
      // Saturday core
      core = ["Bridgette","Stefanie","Missie","Dana"];
    } else {
      // Sunday core
      core = ["Bridgette","Stefanie","Mahala"];
      if (dayNames.includes("Missie")) {
        core.push("Missie");
      }
    }

    // start with core (in day order)
    const output = [];
    dayNames.forEach(n => {
      if (core.includes(n) && !output.includes(n)) {
        output.push(n);
      }
    });

    // remaining = non-core people that are actually scheduled that day
    const remaining = dayNames.filter(n => !core.includes(n));

    // sort remaining by fairnessPriority (lower index = higher priority)
    remaining.sort((a, b) => {
      const ia = fairnessPriority.indexOf(a);
      const ib = fairnessPriority.indexOf(b);
      const va = ia === -1 ? 999 : ia;
      const vb = ib === -1 ? 999 : ib;
      return va - vb;
    });

    // now fill until we hit requestedCount
    for (const name of remaining) {
      if (output.length >= requestedCount) break;
      output.push(name);
    }

    return output;
  }

  function render() {
    const satCount = parseInt(satCountInput.value, 10);
    const sunCount = parseInt(sunCountInput.value, 10);
    const filterName = employeeFilter.value;

    weekContainer.innerHTML = "";

    weekends.forEach(w => {
      const card = document.createElement("div");
      card.className = "week-card";

      const title = document.createElement("div");
      title.className = "week-title";
      title.textContent = w.label;
      card.appendChild(title);

      // SATURDAY
      const satDisplay = getDisplayNames(w.saturday.names, false, satCount);
      const satBlock = document.createElement("div");
      satBlock.className = "day-block";
      satBlock.innerHTML = `
        <div class="day-head">
          <span class="day-name">Saturday</span>
          <span class="day-date">${w.saturday.date}</span>
        </div>
      `;
      const satNamesWrap = document.createElement("div");
      satNamesWrap.className = "names";
      satDisplay.forEach(n => {
        if (filterName === "__all" || n === filterName) {
          const pill = document.createElement("span");
          pill.className = "name-pill";
          pill.textContent = n;
          pill.style.color = colorMap[n] || "black";
          satNamesWrap.appendChild(pill);
        }
      });
      satBlock.appendChild(satNamesWrap);
      if (satCount < 4) {
        const warn = document.createElement("div");
        warn.className = "warn";
        warn.textContent = "Cannot go below Saturday core (4).";
        satBlock.appendChild(warn);
      }
      if (filterName === "__all" || satDisplay.includes(filterName)) {
        card.appendChild(satBlock);
      }

      // SUNDAY
      const sunDisplay = getDisplayNames(w.sunday.names, true, sunCount);
      const sunBlock = document.createElement("div");
      sunBlock.className = "day-block";
      sunBlock.innerHTML = `
        <div class="day-head">
          <span class="day-name">Sunday</span>
          <span class="day-date">${w.sunday.date}</span>
        </div>
      `;
      const sunNamesWrap = document.createElement("div");
      sunNamesWrap.className = "names";
      sunDisplay.forEach(n => {
        if (filterName === "__all" || n === filterName) {
          const pill = document.createElement("span");
          pill.className = "name-pill";
          pill.textContent = n;
          pill.style.color = colorMap[n] || "black";
          sunNamesWrap.appendChild(pill);
        }
      });
      sunBlock.appendChild(sunNamesWrap);
      const baseIsMissieSun = isMissieSunday(w.sunday.names);
      const sunCoreMin = baseIsMissieSun ? 4 : 3;
      if (sunCount < sunCoreMin) {
        const warn = document.createElement("div");
        warn.className = "warn";
        warn.textContent = `Cannot go below Sunday core (${sunCoreMin}).`;
        sunBlock.appendChild(warn);
      }
      if (filterName === "__all" || sunDisplay.includes(filterName)) {
        card.appendChild(sunBlock);
      }

      if (card.querySelectorAll(".day-block").length > 0) {
        weekContainer.appendChild(card);
      }
    });
  }

  satCountInput.addEventListener("input", render);
  sunCountInput.addEventListener("input", render);
  employeeFilter.addEventListener("change", render);

  render();
</script>
