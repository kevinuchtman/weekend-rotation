<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Weekend Rotation Schedule</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #f4f5f7;
      --card: #ffffff;
      --border: #d9dee5;
      --text: #101828;
    }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      margin: 0;
      color: var(--text);
    }
    header {
      background: white;
      border-bottom: 1px solid var(--border);
      padding: 1rem 1.5rem 0.5rem;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    h1 {
      font-size: 1.1rem;
      margin: 0 0 .5rem 0;
    }
    .controls-row {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      align-items: center;
      margin-bottom: .7rem;
    }
    .control-block {
      background: #f8fafc;
      border: 1px solid #edf0f4;
      border-radius: .5rem;
      padding: .4rem .6rem .3rem;
      display: flex;
      flex-direction: column;
      gap: .3rem;
    }
    .control-block label {
      font-size: .7rem;
      color: #475569;
    }
    .control-block input,
    .control-block select {
      max-width: 9rem;
      padding: .2rem .4rem;
    }
    #printBtn, .view-btn {
      padding: 0.5rem 0.8rem;
      border-radius: .5rem;
      border: 1px solid #d9dee5;
      background: #0369a1;
      color: white;
      font-size: .8rem;
      cursor: pointer;
    }
    #printBtn:hover,
    .view-btn.active {
      background: #075985;
    }
    .view-toggle {
      display: flex;
      gap: .5rem;
    }
    main {
      padding: 1.5rem;
      max-width: 1200px;
      margin: 0 auto;
    }
    .hidden {
      display: none !important;
    }
    .week-grid {
      display: grid;
      gap: 1rem;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    }
    .week-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 0.75rem;
      padding: 0.75rem 0.9rem 0.6rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      box-shadow: 0 6px 20px rgba(15, 23, 42, 0.03);
    }
    .week-title {
      font-weight: 600;
      font-size: 0.9rem;
    }
    .day-block {
      background: #f8fafc;
      border: 1px solid #edf0f4;
      border-radius: 0.5rem;
      padding: 0.5rem 0.6rem;
    }
    .day-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: .4rem;
    }
    .day-name {
      font-weight: 600;
      font-size: 0.78rem;
    }
    .day-date {
      font-size: 0.7rem;
      color: #475569;
    }
    .names {
      margin-top: 0.45rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.35rem;
    }
    .name-pill {
      background: #fff;
      border: 1px solid rgba(15,23,42,0.05);
      border-radius: 9999px;
      padding: 0.15rem 0.45rem;
      font-size: 0.68rem;
      line-height: 1.2;
      white-space: nowrap;
    }

    .calendar-wrapper {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .weekend-row {
      background: #fff;
      border: 1px solid #d9dee5;
      border-radius: .75rem;
      padding: .9rem 1.2rem;
      box-shadow: 0 4px 12px rgba(15, 23, 42, 0.03);
      display: flex;
      flex-direction: column;
      gap: .8rem;
    }
    .weekend-title {
      font-weight: 600;
      font-size: .9rem;
      color: #0f172a;
    }
    .weekend-columns {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
    }
    .calendar-day-block {
      background: #f8fafc;
      border: 1px solid #edf0f4;
      border-radius: .5rem;
      padding: .5rem .6rem;
      box-shadow: 0 2px 6px rgba(15,23,42,0.03);
    }
    .calendar-day-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: .35rem;
      gap: .3rem;
    }
    .calendar-day-name {
      font-weight: 600;
      font-size: .78rem;
    }
    .calendar-day-date {
      font-size: .7rem;
      color: #475569;
    }
    .calendar-names {
      display: flex;
      flex-direction: column;
      gap: .2rem;
    }
    .calendar-name {
      font-size: .68rem;
      background: #fff;
      border: 1px solid rgba(15,23,42,.03);
      border-radius: 9999px;
      padding: .12rem .45rem;
      width: fit-content;
    }

    @media (max-width: 700px) {
      .weekend-columns {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
    }

    @media print {
      header {
        display: none !important;
      }
      body {
        background: white;
      }
      @page {
        size: landscape;
        margin: 0.5in;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Weekend Rotation Schedule</h1>
    <div class="controls-row">
      <div class="control-block">
        <label for="startDate">Start Saturday</label>
        <input type="date" id="startDate" value="2025-12-06" />
      </div>
      <div class="control-block">
        <label for="satCount">Saturday headcount</label>
        <input type="number" id="satCount" min="4" max="10" value="6" />
      </div>
      <div class="control-block">
        <label for="sunCount">Sunday headcount</label>
        <input type="number" id="sunCount" min="3" max="10" value="5" />
      </div>
      <div class="control-block">
        <label for="employeeFilter">Filter by employee</label>
        <select id="employeeFilter">
          <option value="__all">Show everyone</option>
        </select>
      </div>
      <div class="view-toggle">
        <button class="view-btn active" data-view="default">Default view</button>
        <button class="view-btn" data-view="calendar">Calendar view</button>
      </div>
      <button id="printBtn">üñ®Ô∏è Print / Export PDF</button>
    </div>
  </header>

  <main>
    <div id="defaultView" class="week-grid"></div>
    <div id="calendarView" class="calendar-wrapper hidden"></div>
  </main>

  <script>
    const baseWeeks = [
      { saturdayNames: ["Bridgette","Stefanie","Missie","Dana","Nate","Kelsey","Becca"], sundayNames: ["Bridgette","Stefanie","Mahala","Holli","Abby","John"] },
      { saturdayNames: ["Bridgette","Stefanie","Missie","Dana","Becca","Abby","John"], sundayNames: ["Bridgette","Stefanie","Mahala","Missie","Paige","Julia"] },
      { saturdayNames: ["Bridgette","Stefanie","Missie","Dana","Holli","Paige","Kathy"], sundayNames: ["Bridgette","Stefanie","Mahala","Kathy","Hannah","Julia"] },
      { saturdayNames: ["Bridgette","Stefanie","Missie","Dana","Nate","Kelsey","Hannah"], sundayNames: ["Bridgette","Stefanie","Mahala","Julia","Rebakah","Maddie"] },
      { saturdayNames: ["Bridgette","Stefanie","Missie","Dana","Maddie","Kay","Julia"], sundayNames: ["Bridgette","Stefanie","Mahala","Missie","Nate","Kelsey"] },
      { saturdayNames: ["Bridgette","Stefanie","Missie","Dana","Julia","Rebakah","John"], sundayNames: ["Bridgette","Stefanie","Mahala","Kay","Becca","Abby"] },
      { saturdayNames: ["Bridgette","Stefanie","Missie","Dana","Nate","Kelsey","Paige"], sundayNames: ["Bridgette","Stefanie","Mahala","John","Kathy","Hannah"] },
      { saturdayNames: ["Bridgette","Stefanie","Missie","Dana","Becca","Abby","Hannah"], sundayNames: ["Bridgette","Stefanie","Mahala","Missie","Julia","Rebakah"] },
      { saturdayNames: ["Bridgette","Stefanie","Missie","Dana","Holli","Kay","John"], sundayNames: ["Bridgette","Stefanie","Mahala","Maddie","Kay","Becca"] },
      { saturdayNames: ["Bridgette","Stefanie","Missie","Dana","Kathy","Hannah","Julia"], sundayNames: ["Bridgette","Stefanie","Mahala","Nate","Kelsey","Becca"] },
      { saturdayNames: ["Bridgette","Stefanie","Missie","Dana","Maddie","Kay","Rebakah"], sundayNames: ["Bridgette","Stefanie","Mahala","Missie","John","Holli"] },
      { saturdayNames: ["Bridgette","Stefanie","Missie","Dana","Julia","Rebakah","Abby"], sundayNames: ["Bridgette","Stefanie","Mahala","Paige","Maddie","Kay"] }
    ];

    const colorMap = {
      "Bridgette": "black",
      "Stefanie": "dimgray",
      "Missie": "purple",
      "Dana": "brown",
      "Mahala": "teal",
      "Nate": "darkorange",
      "Kelsey": "darkorange",
      "Becca": "darkgreen",
      "Abby": "forestgreen",
      "Holli": "royalblue",
      "Paige": "slateblue",
      "Kathy": "darkred",
      "Hannah": "olive",
      "Maddie": "darkcyan",
      "Kay": "chocolate",
      "Julia": "mediumvioletred",
      "Rebakah": "red",
      "John": "navy"
    };

    const fairnessPriority = ["John","Becca","Abby","Hannah","Paige","Kathy","Maddie","Kay","Julia","Rebakah"];
    const protectedOccasional = ["Holli"];

    const defaultView = document.getElementById("defaultView");
    const calendarView = document.getElementById("calendarView");
    const satCountInput = document.getElementById("satCount");
    const sunCountInput = document.getElementById("sunCount");
    const employeeFilter = document.getElementById("employeeFilter");
    const printBtn = document.getElementById("printBtn");
    const startDateInput = document.getElementById("startDate");
    const viewButtons = document.querySelectorAll(".view-btn");

    const allNames = new Set();
    baseWeeks.forEach(w => { w.saturdayNames.forEach(n => allNames.add(n)); w.sundayNames.forEach(n => allNames.add(n)); });
    Array.from(allNames).sort().forEach(n => {
      const opt = document.createElement("option");
      opt.value = n;
      opt.textContent = n;
      employeeFilter.appendChild(opt);
    });

    function parseDateInput(value) {
      const parts = value.split("-");
      return new Date(Number(parts[0]), Number(parts[1]) - 1, Number(parts[2]));
    }
    function addDays(date, days) {
      const d = new Date(date);
      d.setDate(d.getDate() + days);
      return d;
    }
    function formatPretty(date) {
      const opts = { weekday: "short", month: "short", day: "numeric", year: "numeric" };
      return date.toLocaleDateString(undefined, opts);
    }
    function formatShort(date) {
      const opts = { month: "short", day: "numeric" };
      return date.toLocaleDateString(undefined, opts);
    }

    function pickSaturday(names, requested, satCounts) {
      const core = ["Bridgette","Stefanie","Missie","Dana"];
      const selected = [];
      const hasPair = names.includes("Nate") && names.includes("Kelsey");
      const effectiveRequested = hasPair ? requested + 1 : requested;
      names.forEach(n => { if (core.includes(n) && !selected.includes(n)) selected.push(n); });
      let remaining = names.filter(n => !core.includes(n));
      remaining.sort((a,b)=>{const ca=satCounts[a]||0,cb=satCounts[b]||0;if(ca!==cb)return ca-cb;const ia=fairnessPriority.indexOf(a),ib=fairnessPriority.indexOf(b);return (ia===-1?999:ia)-(ib===-1?999:ib);});
      for (const name of remaining) {
        if ((name === "Nate" || name === "Kelsey") && !selected.includes("Nate") && !selected.includes("Kelsey")) {
          if (selected.length + 2 <= effectiveRequested) {
            selected.push("Nate","Kelsey");
          }
          continue;
        }
        if (!selected.includes(name) && selected.length < effectiveRequested) {
          selected.push(name);
        }
      }
      selected.forEach(n => satCounts[n] = (satCounts[n] || 0) + 1);
      return selected;
    }

    function pickSunday(names, requested, sunCounts) {
      const hasPair = names.includes("Nate") && names.includes("Kelsey");
      const effectiveRequested = hasPair ? requested + 1 : requested;
      const core = ["Bridgette","Stefanie","Mahala"];
      if (names.includes("Missie")) core.push("Missie");
      const selected = [];
      names.forEach(n => { if (core.includes(n) && !selected.includes(n)) selected.push(n); });
      const remaining = names.filter(n => !core.includes(n));
      const protectedList = remaining.filter(n => protectedOccasional.includes(n));
      const normalList = remaining.filter(n => !protectedOccasional.includes(n));
      normalList.sort((a,b)=>{const ca=sunCounts[a]||0,cb=sunCounts[b]||0;if(ca!==cb)return ca-cb;const ia=fairnessPriority.indexOf(a),ib=fairnessPriority.indexOf(b);return (ia===-1?999:ia)-(ib===-1?999:ib);});
      for (const p of protectedList) {
        if (selected.length >= effectiveRequested) break;
        selected.push(p);
      }
      for (const n of normalList) {
        if (selected.length >= effectiveRequested) break;
        if ((n === "Nate" || n === "Kelsey") && !selected.includes("Nate") && !selected.includes("Kelsey")) {
          if (selected.length + 2 <= effectiveRequested) {
            selected.push("Nate","Kelsey");
          }
          continue;
        }
        selected.push(n);
      }
      selected.forEach(n => sunCounts[n] = (sunCounts[n] || 0) + 1);
      return selected;
    }

    function render() {
      const satCount = parseInt(satCountInput.value, 10);
      const sunCount = parseInt(sunCountInput.value, 10);
      const filter = employeeFilter.value;
      const start = parseDateInput(startDateInput.value);
      const satCounts = {};
      const sunCounts = {};
      defaultView.innerHTML = "";
      calendarView.innerHTML = "";

      baseWeeks.forEach((weekPattern, idx) => {
        const satDate = addDays(start, idx * 7);
        const sunDate = addDays(satDate, 1);

        const satDisplay = pickSaturday(weekPattern.saturdayNames, satCount, satCounts);
        const sunDisplay = pickSunday(weekPattern.sundayNames, sunCount, sunCounts);

        const card = document.createElement("div");
        card.className = "week-card";
        const title = document.createElement("div");
        title.className = "week-title";
        title.textContent = `Week ${idx + 1}`;
        card.appendChild(title);

        const sunBlock = document.createElement("div");
        sunBlock.className = "day-block";
        sunBlock.innerHTML = `<div class="day-head"><span class="day-name">Sunday</span><span class="day-date">${formatPretty(sunDate)}</span></div>`;
        const sunNamesWrap = document.createElement("div");
        sunNamesWrap.className = "names";
        sunDisplay.forEach(n => {
          if (filter === "__all" || n === filter) {
            const pill = document.createElement("span");
            pill.className = "name-pill";
            pill.textContent = n;
            pill.style.color = colorMap[n] || "black";
            sunNamesWrap.appendChild(pill);
          }
        });
        sunBlock.appendChild(sunNamesWrap);
        if (filter === "__all" || sunDisplay.includes(filter)) {
          card.appendChild(sunBlock);
        }

        const satBlock = document.createElement("div");
        satBlock.className = "day-block";
        satBlock.innerHTML = `<div class="day-head"><span class="day-name">Saturday</span><span class="day-date">${formatPretty(satDate)}</span></div>`;
        const satNamesWrap = document.createElement("div");
        satNamesWrap.className = "names";
        satDisplay.forEach(n => {
          if (filter === "__all" || n === filter) {
            const pill = document.createElement("span");
            pill.className = "name-pill";
            pill.textContent = n;
            pill.style.color = colorMap[n] || "black";
            satNamesWrap.appendChild(pill);
          }
        });
        satBlock.appendChild(satNamesWrap);
        if (filter === "__all" || satDisplay.includes(filter)) {
          card.appendChild(satBlock);
        }

        defaultView.appendChild(card);

        const weekRow = document.createElement("div");
        weekRow.className = "weekend-row";
        const weekendTitle = document.createElement("div");
        weekendTitle.className = "weekend-title";
        weekendTitle.textContent = `Week ${idx + 1}`;
        weekRow.appendChild(weekendTitle);

        const columns = document.createElement("div");
        columns.className = "weekend-columns";

        const sunCol = document.createElement("div");
        sunCol.className = "calendar-day-block";
        sunCol.innerHTML = `<div class="calendar-day-header"><span class="calendar-day-name">Sunday</span><span class="calendar-day-date">${formatShort(sunDate)}</span></div>`;
        const sunNamesCol = document.createElement("div");
        sunNamesCol.className = "calendar-names";
        sunDisplay.forEach(n => {
          if (filter === "__all" || n === filter) {
            const el = document.createElement("div");
            el.className = "calendar-name";
            el.textContent = n;
            el.style.color = colorMap[n] || "black";
            sunNamesCol.appendChild(el);
          }
        });
        sunCol.appendChild(sunNamesCol);
        columns.appendChild(sunCol);

        const satCol = document.createElement("div");
        satCol.className = "calendar-day-block";
        satCol.innerHTML = `<div class="calendar-day-header"><span class="calendar-day-name">Saturday</span><span class="calendar-day-date">${formatShort(satDate)}</span></div>`;
        const satNamesCol = document.createElement("div");
        satNamesCol.className = "calendar-names";
        satDisplay.forEach(n => {
          if (filter === "__all" || n === filter) {
            const el = document.createElement("div");
            el.className = "calendar-name";
            el.textContent = n;
            el.style.color = colorMap[n] || "black";
            satNamesCol.appendChild(el);
          }
        });
        satCol.appendChild(satNamesCol);
        columns.appendChild(satCol);

        weekRow.appendChild(columns);
        calendarView.appendChild(weekRow);
      });
    }

    satCountInput.addEventListener("input", render);
    sunCountInput.addEventListener("input", render);
    employeeFilter.addEventListener("change", render);
    startDateInput.addEventListener("change", render);
    printBtn.addEventListener("click", () => window.print());
    viewButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        viewButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        const view = btn.getAttribute("data-view");
        if (view === "default") {
          defaultView.classList.remove("hidden");
          calendarView.classList.add("hidden");
        } else {
          calendarView.classList.remove("hidden");
          defaultView.classList.add("hidden");
        }
      });
    });

    render();
  </script>
</body>
</html>
